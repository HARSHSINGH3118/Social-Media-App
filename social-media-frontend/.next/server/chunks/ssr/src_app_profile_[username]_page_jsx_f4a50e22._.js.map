{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["file:///H:/Repositories/Social_media_app/social-media-frontend/src/app/profile/%5Busername%5D/page.jsx"],"sourcesContent":["// Updated ProfilePage.jsx with Bio + Stats Bar\r\n\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useParams } from \"next/navigation\";\r\nimport api from \"@/lib/api\";\r\nimport { useAuth } from \"@/contexts/AuthContext\";\r\nimport { Pencil } from \"lucide-react\";\r\n\r\nexport default function ProfilePage() {\r\n  const { username } = useParams();\r\n  const { user: currentUser } = useAuth();\r\n  const [user, setUser] = useState(null);\r\n  const [posts, setPosts] = useState([]);\r\n  const [uploading, setUploading] = useState(false);\r\n  const [editingBio, setEditingBio] = useState(false);\r\n  const [bioInput, setBioInput] = useState(\"\");\r\n\r\n  const isOwnProfile = currentUser?.username === user?.username;\r\n\r\n  useEffect(() => {\r\n    if (!username) return;\r\n    const fetchUserProfile = async () => {\r\n      try {\r\n        const res = await api.get(`/users/profile/${username}`);\r\n        setUser(res.data.user);\r\n        setBioInput(res.data.user.bio || \"\");\r\n        setPosts(res.data.posts || []);\r\n      } catch (err) {\r\n        console.error(\"Error fetching profile:\", err);\r\n      }\r\n    };\r\n    fetchUserProfile();\r\n  }, [username]);\r\n\r\n  const handleAvatarChange = async (e) => {\r\n    const file = e.target.files[0];\r\n    if (!file) return;\r\n    const formData = new FormData();\r\n    formData.append(\"avatar\", file);\r\n    setUploading(true);\r\n    try {\r\n      await api.put(\"/users/profile\", formData, {\r\n        headers: { \"Content-Type\": \"multipart/form-data\" },\r\n      });\r\n      const refreshed = await api.get(`/users/profile/${username}`);\r\n      setUser(refreshed.data.user);\r\n      setPosts(refreshed.data.posts || []);\r\n    } catch (err) {\r\n      console.error(\"Avatar upload failed:\", err);\r\n    } finally {\r\n      setUploading(false);\r\n    }\r\n  };\r\n\r\n  const handleBioSave = async () => {\r\n    try {\r\n      await api.put(\"/users/profile\", { bio: bioInput });\r\n      const refreshed = await api.get(`/users/profile/${username}`);\r\n      setUser(refreshed.data.user);\r\n      setEditingBio(false);\r\n    } catch (err) {\r\n      console.error(\"Bio update failed:\", err);\r\n    }\r\n  };\r\n\r\n  if (!user)\r\n    return (\r\n      <div className=\"text-center mt-20 text-gray-300\">Loading profile...</div>\r\n    );\r\n\r\n  return (\r\n    <div className=\"p-6 max-w-4xl mx-auto\">\r\n      <div className=\"flex items-center gap-6 mb-6\">\r\n        <div className=\"relative w-24 h-24 group\">\r\n          <img\r\n            src={user.avatar || \"/default-avatar.png\"}\r\n            alt=\"Avatar\"\r\n            className=\"w-24 h-24 rounded-full object-cover border-2 border-blue-400\"\r\n          />\r\n          {isOwnProfile && (\r\n            <label className=\"absolute inset-0 flex items-center justify-center rounded-full bg-black/40 opacity-0 group-hover:opacity-100 cursor-pointer\">\r\n              <Pencil size={20} className=\"text-white\" />\r\n              <input\r\n                type=\"file\"\r\n                accept=\"image/*\"\r\n                onChange={handleAvatarChange}\r\n                className=\"hidden\"\r\n              />\r\n            </label>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"flex-1\">\r\n          <h1 className=\"text-3xl font-bold text-blue-400\">@{user.username}</h1>\r\n          <p className=\"text-gray-400 mb-1\">\r\n            Joined: {new Date(user.created_at).toLocaleDateString()}\r\n          </p>\r\n\r\n          <div className=\"text-white mb-2\">\r\n            {editingBio ? (\r\n              <div className=\"flex gap-2 items-center\">\r\n                <input\r\n                  type=\"text\"\r\n                  value={bioInput}\r\n                  onChange={(e) => setBioInput(e.target.value)}\r\n                  className=\"px-2 py-1 rounded bg-gray-800 border text-white\"\r\n                />\r\n                <button\r\n                  className=\"px-2 py-1 bg-blue-500 text-white rounded\"\r\n                  onClick={handleBioSave}\r\n                >\r\n                  Save\r\n                </button>\r\n              </div>\r\n            ) : (\r\n              <div className=\"flex items-center gap-2\">\r\n                <p>{user.bio || (isOwnProfile ? \"No bio added.\" : \"\")}</p>\r\n                {isOwnProfile && (\r\n                  <button onClick={() => setEditingBio(true)}>\r\n                    <Pencil size={16} className=\"text-blue-400\" />\r\n                  </button>\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"flex gap-6 text-white\">\r\n            <p>\r\n              <span className=\"font-semibold\">{posts.length}</span> Posts\r\n            </p>\r\n            <p>\r\n              <span className=\"font-semibold\">0</span> Followers\r\n            </p>\r\n            <p>\r\n              <span className=\"font-semibold\">0</span> Following\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <h2 className=\"text-2xl font-semibold mb-2 text-white\">Posts</h2>\r\n      {posts.length === 0 ? (\r\n        <p className=\"text-gray-400\">No posts yet.</p>\r\n      ) : (\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n          {posts.map((post) => (\r\n            <div\r\n              key={post.id}\r\n              className=\"bg-white rounded-lg p-4 shadow text-black\"\r\n            >\r\n              {post.image_url && (\r\n                <img\r\n                  src={post.image_url}\r\n                  alt=\"Post\"\r\n                  className=\"w-full h-60 object-cover mb-2 rounded\"\r\n                />\r\n              )}\r\n              <p className=\"mb-2\">{post.content}</p>\r\n              <p className=\"text-sm text-gray-600\">{post.like_count} likes</p>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}